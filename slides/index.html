<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>Introduction à Spring MVC</title>

		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/solarized.css">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="atom-one-light.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>

		<style>
			.reveal .main-title {
                /* Empty */
			}

			.reveal .chapter {
                /* Empty */
			}

            .reveal .center {
                text-align: center;
            }

            .reveal .chapter h2 {
                font-size: 5em;
            }

			.reveal .slides img {
				border: none;
				background: none;
				box-shadow: none;
				height: auto;
			}

            .reveal .slides {
                font-size: 30px;
            }

			.reveal .slide-background.present {
				opacity: 0.1;
			}

            .reveal .slide {
				text-align: left;
			}

            .reveal pre {
                width: 100%;
            }

			.reveal code {
                /*font-size: 70%;*/
                line-height: 22px;
			}

			.reveal pre code {
                max-height: none;
			}

			.reveal ul {
				list-style-type: none;
			}

            .reveal ul ul {
                list-style-type: none;
            }

			.reveal ul li:before {
				content: '–';
				margin-right: 7px;
			}
		</style>
	</head>
	<body>
		<div class="reveal">
			<div class="slides">
				<section class="main-title">
					<h1>Introduction à Spring MVC</h1>
					<h3>Formation des développeurs</h3>
					<p>
						<small>Romain Warnan</small>
					</p>
					<table>
						<tr>
							<td><img src="images/spring.png" style="width: 100px;" /></td>
							<td><img src="images/java-8.png" style="width: 100px;" /></td>
							<td><img src="images/maven.png" style="width: 100px;" /></td>
							<td><img src="images/tomcat.png" style="width: 100px;" /></td>
							<td><img src="images/ajax.png" style="width: 100px;" /></td>
							<td><img src="images/github.png" style="width: 100px;" /></td>
							<td><img src="images/jquery.png" style="width: 100px;" /></td>
						</tr>
					</table>
				</section>

                <!-- Chapitre 1 -->
                <section
                    data-markdown="chapters/1-spring-core-rappels.md"
                    data-separator="^(\r?\n){4,}$" data-separator-vertical="^\r?\n---\r?\n$">
                </section>

                <!-- Chapitre 2 -->
                <section data-markdown data-background-image="images/spring.png" data-background-size="1200px" class="chapter">
                    ## 2
                    ### Spring MVC : généralités
                </section>
                <section class="slide">
                    <h3>Classement des frameworks web en 2017</h3>
                    <div class="center">
                        <img src="images/web-frameworks.png" style="width: 600px" />
                    </div>
                </section>
                <section data-markdown class="slide">
                    ### Dépendances Maven
                    ```xml
                    &lt;dependency&gt;
                        &lt;groupId&gt;org.springframework&lt;/groupId&gt;
                        &lt;artifactId&gt;spring-webmvc&lt;/artifactId&gt;
                        &lt;version&gt;${spring.version}&lt;/version&gt;
                    &lt;/dependency&gt;
                    &lt;dependency&gt;
                        &lt;groupId&gt;javax.servlet&lt;/groupId&gt;
                        &lt;artifactId&gt;javax.servlet-api&lt;/artifactId&gt;
                        &lt;version&gt;3.1.0&lt;/version&gt;
                        &lt;scope&gt;provided&lt;/scope&gt;
                    &lt;/dependency&gt;
                    &lt;dependency&gt;
                        &lt;groupId&gt;javax.servlet.jsp&lt;/groupId&gt;
                        &lt;artifactId&gt;jsp-api&lt;/artifactId&gt;
                        &lt;version&gt;2.2&lt;/version&gt;
                        &lt;scope&gt;provided&lt;/scope&gt;
                    &lt;/dependency&gt;
                    &lt;dependency&gt;
                        &lt;groupId&gt;jstl&lt;/groupId&gt;
                        &lt;artifactId&gt;jstl&lt;/artifactId&gt;
                        &lt;version&gt;1.2&lt;/version&gt;
                    &lt;/dependency&gt;
                    ```
                </section>
                <section class="slide">
                    <h3>Modèle MVC</h3>
                    <p>Modèle &ndash; Vue &ndash; Contrôleur</p>
                    <div class="center">
                        <img src="images/modele-mvc.png" style="width: 1000px" />
                    </div>
                </section>
                <section data-markdown class="slide">
                    ### Le contrôleur frontal : ServletDispatcher
                    Toutes les requêtes sont interceptées par la même servlet

                    ServletDispatcher, fournie par Spring MVC

                     1. intercepte la requête
                     2. délègue la requête au contrôleur adéquat
                     3. récupère le modèle
                     4. transmet le modèle au générateur de vue
                     5. récupère la vue générée
                     6. retourne la réponse au client

                    La servlet possède son propre contexte Spring
                </section>
                <section data-markdown class="slide">
                    ### Déclarer la servlet ServletDispatcher

                    ```xml
                    &lt;servlet&gt;
                        &lt;servlet-name&gt;servlet-dispatcher&lt;/servlet-name&gt;
                        &lt;servlet-class&gt;org.springframework.web.servlet.DispatcherServlet&lt;/servlet-class&gt;
                        &lt;init-param&gt;
                            &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;
                            &lt;param-value&gt;classpath:servlet-dispatcher.xml&lt;/param-value&gt;
                        &lt;/init-param&gt;
                        &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;
                    &lt;/servlet&gt;
                    &lt;servlet-mapping&gt;
                        &lt;servlet-name&gt;servlet-dispatcher&lt;/servlet-name&gt;
                        &lt;url-pattern&gt;/&lt;/url-pattern&gt;
                    &lt;/servlet-mapping&gt;
                    ```

                    Attention : « / » et pas « /* »
                </section>
                <section data-markdown class="slide">
                    ### Configurer les servlets

                    Dans l’exemple, on redirige toutes les URL vers Spring MVC

                    On peut exclure certaines ressources
                     - ressources statiques par exemple

                    Attention : l’ordre de déclaration dans web.xml est important

                    ```xml
                    &lt;servlet&gt;
                        &lt;servlet-name&gt;default&lt;/servlet-name&gt;
                        &lt;servlet-class&gt;org.apache.catalina.servlets.DefaultServlet&lt;/servlet-class&gt;
                        &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;
                    &lt;/servlet&gt;
                    &lt;servlet-mapping&gt;
                        &lt;servlet-name&gt;default&lt;/servlet-name&gt;
                        &lt;url-pattern&gt;/static/*&lt;/url-pattern&gt;
                    &lt;/servlet-mapping&gt;
                    ```
                </section>
				<section class="slide">
					<h3>Hiérarchie des contextes</h3>
					<div class="center">
						<img src="images/double-contexte.png" style="width: 700px" />
					</div>
				</section>
				<section data-markdown class="slide">
					### Le résolveur de vues

					Indiquer à Spring quelle vue utiliser
					- JSP, Tiles…

					En général
					- `InternalResourceViewResolver`
					- À paramétrer pour faire la relation entre une chaîne de caractère et une JSP

					Attention : l’ordre de déclaration dans web.xml est important

					```xml
					&lt;bean id="viewResolver" class="org.springframework.web.servlet.view.InternalResourceViewResolver"&gt;
						&lt;property name="prefix"&gt;
							&lt;value&gt;/WEB-INF/views/&lt;/value&gt;
						&lt;/property&gt;
						&lt;property name="suffix"&gt;
							&lt;value&gt;.jsp&lt;/value&gt;
						&lt;/property&gt;
					&lt;/bean&gt;
					```
				</section>
			</div>
		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>

		<script>
			// More info about config & dependencies:
			// - https://github.com/hakimel/reveal.js#configuration
			// - https://github.com/hakimel/reveal.js#dependencies
			Reveal.initialize({
				dependencies: [
					{ src: 'plugin/markdown/marked.js' },
					{ src: 'plugin/markdown/markdown.js' },
					{ src: 'plugin/notes/notes.js', async: true },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }
				]
			});
            Reveal.configure({
				slideNumber: 'c/t',
				history: true,
			});
		</script>
	</body>
</html>